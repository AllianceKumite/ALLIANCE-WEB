<!-- <div style="display: none">
    <participant-flags></participant-flags>
</div> -->

<div class="d-flex row p-0 m-0" style="flex-wrap: wrap-reverse;">
    <div class="col-sm-12 col-md-6 col-lg-7 p-2 m-0">
        <div class="row ps-2 pe-4">
            <div class="col-6 col-md-3">
                <ng-select #tatamiManageSelector (change)="onTatamiChange()" [searchable]="false"
                    placeholder="{{ 'navbar.tatami' | translate }}" bindLabel="name" bindValue="id"
                    name="selectedTatami" [(ngModel)]="filter.tatami" dropdownPosition="bottom" class="form-control"
                    [clearable]="false">
                    <ng-option *ngFor="let tatami of tatamis" [value]="tatami">
                        <tatami-title [id]='tatami' [tatamiType]='tatamiType'></tatami-title>
                    </ng-option>
                </ng-select>
            </div>

            <div class="col-6 col-md-3">
                <ng-select #timeManageSelector bindLabel="coachName" bindValue="coachId" placeholder="Time"
                    name="selectedTime" [items]="subtimes" [(ngModel)]="filter.time" (ngModelChange)="onTimeChange()"
                    class="form-control" [clearable]="false" [disabled]="subtimes && subtimes.length == 1"></ng-select>
            </div>

            <div class="col-8  col-md-4">
                <ng-select #manageCategoriesSelector bindLabel="name" bindValue="id" [(ngModel)]="filter.category"
                    (change)="onCategoryChange()" [searchable]="false" class="form-control"
                    placeholder="{{ 'dataTable.category' | translate }}" name="selectedDraw" dropdownPosition="bottom"
                    [clearable]="false">
                    <ng-option>{{ 'manage.allCategories' | translate}}</ng-option>
                    <ng-option *ngFor="let category of categories" [value]="category">
                        <app-category-name id="{{category}}"></app-category-name>
                    </ng-option>
                </ng-select>
            </div>
            <div class="col-4 col-md-2 d-flex justify-content-between align-items-center">
                <div class="box-button">
                    <!-- отменить все поединки -->
                    <button type="button" class="btn btn-danger" title="{{'manage.cancelAll' | translate}}"
                        (click)="cancelAll()">
                        <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision"
                            text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd"
                            clip-rule="evenodd" width="28" height="28" fill="#fff" viewBox="0 0 419 511.67">
                            <path
                                d="M93 39.4h46.12C141.84 17.18 159.77 0 181.52 0c21.61 0 39.45 16.95 42.34 38.94l46.76.46c2.6 0 4.7 2.09 4.7 4.71v51.84c0 2.6-2.1 4.7-4.7 4.7H93.05c-2.55 0-4.71-2.1-4.71-4.7V44.11A4.638 4.638 0 0 1 93 39.4zm221.98 264.22c57.47 0 104.02 46.59 104.02 104.03 0 57.47-46.58 104.02-104.02 104.02-57.48 0-104.02-46.58-104.02-104.02 0-57.48 46.58-104.03 104.02-104.03zm40.59 88.45c4.59-.03 7.86-.46 7.78 5.24l-.22 18.44c.03 5.95-1.86 7.54-7.43 7.47h-81.46c-5.58.07-7.46-1.52-7.43-7.47l-.22-18.44c-.09-5.7 3.2-5.27 7.79-5.24h81.19zM41.73 59.27h23.93v24.38H41.73c-4.54 0-8.69 1.76-11.79 4.6l-.46.49c-3.14 3.14-5.1 7.49-5.1 12.25v315.53c0 4.75 1.96 9.09 5.1 12.24 3.13 3.15 7.49 5.11 12.25 5.11h142.61c1.69 8.44 4.18 16.6 7.37 24.38H41.73c-11.41 0-21.85-4.71-29.42-12.27C4.72 438.44 0 427.99 0 416.52V100.99c0-11.48 4.7-21.92 12.25-29.47l.8-.72c7.49-7.13 17.61-11.53 28.68-11.53zm297.55 217.37V100.99c0-4.74-1.97-9.09-5.12-12.24-3.12-3.15-7.46-5.1-12.24-5.1h-23.91V59.27h23.91c11.43 0 21.85 4.71 29.42 12.26 7.6 7.56 12.31 18.01 12.31 29.46V283.6c-7.78-3.06-15.94-5.41-24.37-6.96zm-206.75-8.07c-7.13 0-12.92-5.79-12.92-12.93 0-7.13 5.79-12.92 12.92-12.92h142.82c7.13 0 12.93 5.79 12.93 12.92 0 7.14-5.8 12.93-12.93 12.93H132.53zM89.5 241.21c7.98 0 14.44 6.46 14.44 14.44 0 7.98-6.46 14.44-14.44 14.44-7.97 0-14.44-6.46-14.44-14.44 0-7.98 6.47-14.44 14.44-14.44zm0 78.63c7.98 0 14.44 6.45 14.44 14.43 0 7.98-6.46 14.44-14.44 14.44-7.97 0-14.44-6.46-14.44-14.44 0-7.98 6.47-14.43 14.44-14.43zm43.04 27.35c-7.13 0-12.93-5.79-12.93-12.93 0-7.13 5.8-12.92 12.93-12.92h80.96a133.608 133.608 0 0 0-17.26 25.85h-63.7zM89.5 162.6c7.98 0 14.44 6.46 14.44 14.44 0 7.98-6.46 14.44-14.44 14.44-7.97 0-14.44-6.46-14.44-14.44 0-7.98 6.47-14.44 14.44-14.44zm43.03 27.36c-7.13 0-12.92-5.79-12.92-12.92s5.79-12.93 12.92-12.93h142.82c7.13 0 12.93 5.8 12.93 12.93s-5.8 12.92-12.93 12.92H132.53zm48.5-169.81c12.3 0 22.26 9.98 22.26 22.27 0 12.3-9.96 22.26-22.26 22.26-12.29 0-22.26-9.96-22.26-22.26 0-12.29 9.97-22.27 22.26-22.27z" />
                        </svg>
                    </button>
                    <!-- отложить категорию -->
                    <button type="button" class="btn btn-warning" title="{{'manage.postponeCategory' | translate}}"
                        (click)="postponeCategory()" [disabled]="!isPostponeCategoryButtonEnabled()">
                        <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24" height="24"
                            fill="#fff" viewBox="0 0 122.879 119.801" enable-background="new 0 0 122.879 119.801"
                            xml:space="preserve">
                            <g>
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M49.991,0h0.015v0.006c13.794,0.004,26.294,5.601,35.336,14.645 c9.026,9.031,14.618,21.515,14.628,35.303h0.006v0.034v0.04h-0.006c-0.005,5.557-0.918,10.905-2.594,15.892 c-0.281,0.837-0.576,1.641-0.877,2.409v0.007c-1.446,3.661-3.315,7.12-5.548,10.307l29.08,26.14l0.018,0.015l0.157,0.146 l0.012,0.012c1.641,1.563,2.535,3.656,2.648,5.779c0.11,2.1-0.538,4.248-1.976,5.971l-0.011,0.016l-0.176,0.204l-0.039,0.046 l-0.145,0.155l-0.011,0.011c-1.563,1.642-3.656,2.539-5.782,2.651c-2.104,0.111-4.254-0.54-5.975-1.978l-0.012-0.012l-0.203-0.175 l-0.029-0.024L78.764,90.865c-0.88,0.62-1.779,1.207-2.687,1.763c-1.234,0.756-2.51,1.467-3.816,2.117 c-6.699,3.342-14.266,5.223-22.27,5.223v0.006h-0.016v-0.006c-13.797-0.005-26.297-5.601-35.334-14.644l-0.004,0.005 C5.608,76.3,0.016,63.81,0.007,50.021H0v-0.033v-0.016h0.007c0.005-13.799,5.601-26.297,14.646-35.339 C23.684,5.607,36.169,0.015,49.958,0.006V0H49.991L49.991,0z M67.787,43.397c1.21-0.007,2.353,0.312,3.322,0.872l-0.002,0.002 c0.365,0.21,0.708,0.454,1.01,0.715c0.306,0.264,0.594,0.569,0.851,0.895h0.004c0.873,1.11,1.397,2.522,1.394,4.053 c-0.003,1.216-0.335,2.358-0.906,3.335c-0.454,0.78-1.069,1.461-1.791,1.996c-0.354,0.261-0.751,0.496-1.168,0.688v0.002 c-0.823,0.378-1.749,0.595-2.722,0.6l-35.166,0.248c-1.209,0.011-2.354-0.31-3.327-0.873l0.002-0.002 c-0.37-0.212-0.715-0.458-1.016-0.722c-0.306-0.264-0.589-0.567-0.844-0.891h-0.004c-0.873-1.112-1.397-2.522-1.393-4.053 c0.002-1.213,0.337-2.354,0.906-3.328l-0.004-0.002c0.376-0.642,0.869-1.225,1.442-1.714h0.004 c0.574-0.489,1.236-0.883,1.942-1.151c0.704-0.266,1.484-0.418,2.296-0.423L67.787,43.397L67.787,43.397z M50.006,11.212v0.006 h-0.015h-0.034v-0.006C39.274,11.219,29.59,15.56,22.581,22.566l0.002,0.002c-7.019,7.018-11.365,16.711-11.368,27.404h0.006v0.016 v0.033h-0.006c0.006,10.683,4.347,20.365,11.354,27.377l0.002-0.002c7.018,7.018,16.711,11.365,27.404,11.367v-0.007h0.016h0.033 v0.007c10.685-0.007,20.367-4.348,27.381-11.359c7.012-7.009,11.359-16.702,11.361-27.401H88.76v-0.015v-0.034h0.007 C88.76,39.273,84.419,29.591,77.407,22.58v-0.007C70.398,15.562,60.705,11.214,50.006,11.212L50.006,11.212z" />
                            </g>
                        </svg>
                    </button>
                    <!-- снять все отметки отложенные поединки -->
                    <button type="button" class="btn btn-warning" title="{{'manage.unpostponeAll' | translate}}"
                        (click)="unpostponeAll()">
                        <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24" height="24"
                            fill="#fff" viewBox="0 0 122.879 119.801" enable-background="new 0 0 122.879 119.801"
                            xml:space="preserve">
                            <g>
                                <path
                                    d="M49.991,0h0.015v0.006c13.794,0.004,26.294,5.601,35.336,14.645c9.026,9.031,14.618,21.515,14.628,35.303h0.006v0.034v0.04 h-0.006c-0.005,5.557-0.918,10.905-2.594,15.892c-0.281,0.837-0.576,1.641-0.877,2.409v0.007c-1.446,3.661-3.315,7.12-5.548,10.307 l29.08,26.14l0.018,0.015l0.157,0.146l0.012,0.012c1.641,1.563,2.535,3.656,2.648,5.779c0.11,2.1-0.538,4.248-1.976,5.971 l-0.011,0.016l-0.176,0.204l-0.039,0.046l-0.145,0.155l-0.011,0.011c-1.563,1.642-3.656,2.539-5.782,2.651 c-2.104,0.111-4.254-0.54-5.975-1.978l-0.012-0.012l-0.203-0.175l-0.029-0.024L78.764,90.865c-0.88,0.62-1.779,1.207-2.687,1.763 c-1.234,0.756-2.51,1.467-3.816,2.117c-6.699,3.342-14.266,5.223-22.27,5.223v0.006h-0.016v-0.006 c-13.797-0.005-26.297-5.601-35.334-14.644l-0.004,0.005C5.608,76.3,0.016,63.81,0.007,50.021H0v-0.033v-0.016h0.007 c0.005-13.799,5.601-26.297,14.646-35.339C23.684,5.607,36.169,0.015,49.958,0.006V0H49.991L49.991,0z M67.787,43.397 c1.21-0.007,2.353,0.312,3.322,0.872l-0.002,0.002c0.365,0.21,0.708,0.454,1.01,0.715c0.306,0.264,0.594,0.569,0.851,0.895h0.004 c0.873,1.11,1.397,2.522,1.394,4.053c-0.003,1.216-0.335,2.358-0.906,3.335c-0.454,0.78-1.069,1.461-1.791,1.996 c-0.354,0.261-0.751,0.496-1.168,0.688v0.002c-0.823,0.378-1.749,0.595-2.722,0.6l-11.051,0.08l-0.08,11.062 c-0.004,1.034-0.254,2.02-0.688,2.886c-0.188,0.374-0.417,0.737-0.678,1.074l-0.006,0.007c-0.257,0.329-0.551,0.644-0.866,0.919 c-1.169,1.025-2.713,1.649-4.381,1.649v-0.007c-0.609,0-1.195-0.082-1.743-0.232c-1.116-0.306-2.115-0.903-2.899-1.689 c-0.788-0.791-1.377-1.787-1.672-2.893v-0.006c-0.144-0.543-0.22-1.128-0.215-1.728v-0.005l0.075-10.945l-10.962,0.076 c-1.209,0.011-2.354-0.31-3.327-0.873l0.002-0.002c-0.37-0.212-0.715-0.458-1.016-0.722c-0.306-0.264-0.589-0.567-0.844-0.891 h-0.004c-0.873-1.112-1.397-2.522-1.393-4.053c0.002-1.213,0.337-2.354,0.906-3.328l-0.004-0.002 c0.376-0.642,0.869-1.225,1.442-1.714h0.004c0.574-0.489,1.236-0.883,1.942-1.151c0.704-0.266,1.484-0.418,2.296-0.423 l11.051-0.082l0.08-11.062c0.004-1.207,0.345-2.345,0.921-3.309l0.004,0.002c0.224-0.374,0.467-0.715,0.727-1.003 c0.264-0.296,0.576-0.584,0.908-0.839l0.005-0.004v0.002c1.121-0.861,2.533-1.379,4.055-1.375c1.211,0.002,2.352,0.332,3.317,0.897 c0.479,0.279,0.928,0.631,1.32,1.025l0.004-0.004c0.383,0.383,0.73,0.834,1.019,1.333c0.56,0.968,0.879,2.104,0.868,3.304 l-0.075,10.942L67.787,43.397L67.787,43.397z M50.006,11.212v0.006h-0.015h-0.034v-0.006C39.274,11.219,29.59,15.56,22.581,22.566 l0.002,0.002c-7.019,7.018-11.365,16.711-11.368,27.404h0.006v0.016v0.033h-0.006c0.006,10.683,4.347,20.365,11.354,27.377 l0.002-0.002c7.018,7.018,16.711,11.365,27.404,11.367v-0.007h0.016h0.033v0.007c10.685-0.007,20.367-4.348,27.381-11.359 c7.012-7.009,11.359-16.702,11.361-27.401H88.76v-0.015v-0.034h0.007C88.76,39.273,84.419,29.591,77.407,22.58v-0.007 C70.398,15.562,60.705,11.214,50.006,11.212L50.006,11.212z" />
                            </g>
                        </svg>
                    </button>

                    <button type="button" class="btn btn-success" (click)="scrollToCurrentFight()"
                        title="{{'manage.gotocurrent' | translate}}">
                        <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24" height="24"
                            fill="#fff" viewBox="0 0 122.88 98.86" style="enable-background:new 0 0 122.88 98.86"
                            xml:space="preserve">
                            <style type="text/css">
                                .st0 {
                                    fill-rule: evenodd;
                                    clip-rule: evenodd;
                                }
                            </style>
                            <g>
                                <path class="st0"
                                    d="M122.88,49.43L73.95,98.86V74.23C43.01,67.82,18.56,74.89,0,98.42c3.22-48.4,36.29-71.76,73.95-73.31l0-25.11 L122.88,49.43L122.88,49.43z" />
                            </g>
                        </svg>
                    </button>
                    <ng-container>
                        <a target="_blank" href="{{ videofile }}">
                            <button type="button" class="btn btn-primary" title="Youtube help video"
                                style="object-fit:contain">
                                <i class="fa fa-2x fa-youtube" aria-hidden="true"></i>
                            </button>
                        </a>
                    </ng-container>
                </div>
            </div>
        </div>

        <div class="row p-1 m-0" style="font-size: 70%; background-color: transparent">
            <div class="box-fight">
                <div id="managed-fights" class="row"
                    style="margin-right: 0; margin-left: 0; background-color: transparent;">
                    <div *ngFor="let fight of fights; let i = index;" class="col-sm-12 col-md-12 col-lg-6 p-1 m-0">
                        <fight [viewType]="'manageFightListItem'" [fight]="fight" [headerColor]="1"
                            [champType]="champType" [champName]="filter.title" [selectable]="SELECTABLE"
                            [tatamiId]="filter.tatami" [onSelectCallback]="deselectOtherFights" [onCancel]="cancelFight"
                            [onPostpone]="postponeFight" [onUnpostpone]="unpostponeFight" [fightcount]="countFight"
                            [katas]="katas" [katagroups]="kataGroups"></fight>
                    </div>
                </div>
            </div>
        </div>
        <div class="row p-1 m-0" style="font-size: 70%; background-color: transparent">
            <div class="row p-3">
                <h5>
                    {{ 'manage.totalfight' | translate}}{{filter.tatami}}: {{ countFight }} {{'manage.current' | translate}}(
                    {{currentFight?.details?.NumDuel}} [{{ countFight - currentFight?.details?.NumDuel + 1 }}]
                    )
                </h5>
                <h5>
                    {{ 'manage.estimatedtime' | translate}} {{getEstimatedTime()}}
                </h5>
            </div>
        </div>
    </div>

    <div class="col-sm-12 col-md-6 col-lg-5 p-2 m-0">
        <confirm-modal text="Winner is aka o shiro. Please confirm."></confirm-modal>

        <div id="manage-fight-in-detail" style="background-color: #ddd; width: 100%; padding: 0">
            <div *ngIf="isManageWithFlags(currentFight)">
                <fight [viewType]="'manageFightInDetailsWithFlags'" [fight]="currentFight" [headerColor]="1"
                    [champType]="champType" [champName]="filter.title" [tatamiId]="filter.tatami"
                    [categoryFilter]="filter.category" [addWindow]="openCurrentFightWindow" [katas]="katas"
                    [katagroups]="kataGroups" (updateInfoLevel)="doOnUdpadeLevel($event)"></fight>
            </div>

            <div *ngIf="isManageWithMarks(currentFight)">
                <fight [viewType]="'manageFightInDetailsWithMarks'" [fight]="currentFight" [headerColor]="1"
                    [champType]="champType" [champName]="filter.title" [tatamiId]="filter.tatami"
                    [categoryFilter]="filter.category" [addWindow]="openCurrentFightWindow" [katas]="katas"
                    [katagroups]="kataGroups"></fight>
            </div>

            <div *ngIf="!isCurrentFight()" style="font-size: 2em; text-align: center; height: 15em; padding-top: 3em;">
                {{ 'manage.noFights' | translate}}
            </div>
        </div>
    </div>
</div>